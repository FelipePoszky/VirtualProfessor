<ChatBubble>: #:kivy !
    id:chtbld
    md_bg_color: [0, 0, 0, 0]
    size_hint_y: None
    height: dp(60)
    adaptive_height: True
    width: root.width
    padding: [10, 0, 10, 0]
    orientation: 'vertical'

    MDBoxLayout:
        height: msg_content.height + time.height + 15
        width: msg_content.width + wid1.width + wid3.width
        size_hint: None, None
        pos_hint: {'right': 1} if chtbld.sender == 'you' else {'left': 1}
        radius: [10, 10, -2.5, 10] if self.pos_hint == {'right': 1} else [10, 10, 10, -2.5]
        md_bg_color: app.theme_cls.bg_dark

        Spacer:
            id: wid1

        MDBoxLayout:
            orientation: 'vertical'
            height: msg_content.height + onlytime.height
            width: msg_content.width

            MDLabel:
                id: msg_content
                text: root.msg
                width: self.texture_size[0] if self.texture_size[0] >= 60 else 60
                height: self.texture_size[1]
                size_hint_y: None
                text_size: chtbld.width - 70 if self.width >= chtbld.width - 70 else None, None
                halign: 'left'
                color: app.theme_cls.opposite_bg_normal
                font_size: sp(13)

            MDBoxLayout:
                id: onlytime
                size_hint_y: None
                height: time.height + 5
                width: time.width + 3
                spacing: 3
                pos_hint: {'right': 1} if chtbld.sender == 'you' else {'left': 1}  # Agregado
                MDLabel:
                    id: time
                    text: root.time
                    size: self.texture_size
                    size_hint_y: None
                    font_size: sp(9)
                    bold: True
                    halign: 'right' if chtbld.sender == 'you' else 'left'  # Modificado
                    text_size: None, None
                    color: [.8, .8, .8, 1]

            Spacer:
                id: wid2
                height: 5
        Spacer:
            id: wid3

<Spacer@Widget>:
    id: wid
    width: 10
    size_hint: None, None